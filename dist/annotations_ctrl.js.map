{"version":3,"sources":["../src/annotations_ctrl.js"],"names":["showAnnotationsOptions","CheckmkAnnotationsQueryCtrl","target","site","host","service","show","reduce","all","option","annotation","queries","datasource","sitesQuery","hostsQuery","servicesQuery","update","showAnnotations","filter","annotationType","templateUrl"],"mappings":";;;;;;;;;;AAAA,IAAMA,yBAAyB,CAC3B,IAD2B,EAE3B,MAF2B,EAG3B,MAH2B,EAI3B,SAJ2B,EAK3B,UAL2B,EAM3B,WAN2B,EAO3B,aAP2B,EAQ3B,2BAR2B,EAS3B,sBAT2B,EAU3B,aAV2B,CAA/B;;IAaaC,2B,WAAAA,2B;AACT,2CAAY,yBAA2B;AAAA;;AACnC,aAAKC,MAAL,GAAc,KAAKA,MAAL,IAAe,EAA7B;AACA,aAAKA,MAAL,CAAYC,IAAZ,GAAmB,KAAKD,MAAL,CAAYC,IAAZ,IAAoB,EAAvC;AACA,aAAKD,MAAL,CAAYE,IAAZ,GAAmB,KAAKF,MAAL,CAAYE,IAAZ,IAAoB,EAAvC;AACA,aAAKF,MAAL,CAAYG,OAAZ,GAAsB,KAAKH,MAAL,CAAYG,OAAZ,IAAuB,EAA7C;;AAEA,aAAKH,MAAL,CAAYI,IAAZ,GAAmBN,uBAAuBO,MAAvB,CAA8B,UAACC,GAAD,EAAMC,MAAN,EAAiB;AAC9DD,gBAAIC,MAAJ,IAAcD,IAAIC,MAAJ,KAAe,IAAf,GAAsBD,IAAIC,MAAJ,CAAtB,GAAoC,IAAlD;AACA,mBAAOD,GAAP;AACH,SAHkB,EAGhB,KAAKN,MAAL,CAAYI,IAAZ,IAAoB,EAHJ,CAAnB;;AAKA,aAAKI,UAAL,CAAgBC,OAAhB,GAA0B,KAAKD,UAAL,CAAgBC,OAAhB,IAA2B,EAArD;AACH;;;;uCAEc;AACX,mBAAO,IAAP;AACH;;;yCAEgB;AACb,mBAAO,KAAKC,UAAL,CAAgBC,UAAhB,CAA2B,KAAKX,MAAhC,EAAwC,IAAxC,CAAP;AACH;;;yCAEgB;AACb,mBAAO,KAAKU,UAAL,CAAgBE,UAAhB,CAA2B,KAAKZ,MAAhC,CAAP;AACH;;;4CAEmB;AAChB,mBAAO,KAAKU,UAAL,CAAgBG,aAAhB,CAA8B,KAAKb,MAAnC,CAAP;AACH;;;uCAEc;AACX,iBAAKA,MAAL,CAAYE,IAAZ,GAAmB,EAAnB;AACA,iBAAKF,MAAL,CAAYG,OAAZ,GAAsB,EAAtB;AACA,iBAAKW,MAAL;AACH;;;uCAEc;AACX,iBAAKd,MAAL,CAAYG,OAAZ,GAAsB,EAAtB;AACA,iBAAKW,MAAL;AACH;;;0CAEiB;AACd,iBAAKA,MAAL;AACH;;;iDAEwB;AACrB,iBAAKA,MAAL;AACH;;;iCAEQ;AAAA;;AACL,iBAAKN,UAAL,CAAgBC,OAAhB,GAA0B,CAAC;AACvBR,sBAAM,KAAKD,MAAL,CAAYC,IADK;AAEvBC,sBAAM,KAAKF,MAAL,CAAYE,IAFK;AAGvBC,yBAAS,KAAKH,MAAL,CAAYG,OAHE;AAIvBY,iCAAiBjB,uBAAuBkB,MAAvB,CAA8B,UAACC,cAAD;AAAA,2BAAoB,MAAKjB,MAAL,CAAYI,IAAZ,CAAiBa,cAAjB,CAApB;AAAA,iBAA9B;AAJM,aAAD,CAA1B;AAMH;;;;;;AAGLlB,4BAA4BmB,WAA5B,GAA0C,kCAA1C","file":"annotations_ctrl.js","sourcesContent":["const showAnnotationsOptions = [\n    'ok',\n    'warn',\n    'crit',\n    'unknown',\n    'flapping',\n    'host_down',\n    'in_downtime',\n    'outof_notification_period',\n    'outof_service_period',\n    'unmonitored'\n];\n\nexport class CheckmkAnnotationsQueryCtrl {\n    constructor(/*timeSrv, dashboardSrv*/) {\n        this.target = this.target || {};\n        this.target.site = this.target.site || '';\n        this.target.host = this.target.host || '';\n        this.target.service = this.target.service || '';\n\n        this.target.show = showAnnotationsOptions.reduce((all, option) => {\n            all[option] = all[option] != null ? all[option] : true;\n            return all;\n        }, this.target.show || {});\n\n        this.annotation.queries = this.annotation.queries || [];\n    }\n\n    getLastError() {\n        return null;\n    }\n\n    getSiteOptions() {\n        return this.datasource.sitesQuery(this.target, true);\n    }\n\n    getHostOptions() {\n        return this.datasource.hostsQuery(this.target);\n    }\n\n    getServiceOptions() {\n        return this.datasource.servicesQuery(this.target);\n    }\n\n    onSiteChange() {\n        this.target.host = '';\n        this.target.service = '';\n        this.update();\n    }\n\n    onHostChange() {\n        this.target.service = '';\n        this.update();\n    }\n\n    onServiceChange() {\n        this.update();\n    }\n\n    onShowAnnotationChange() {\n        this.update();\n    }\n\n    update() {\n        this.annotation.queries = [{\n            site: this.target.site,\n            host: this.target.host,\n            service: this.target.service,\n            showAnnotations: showAnnotationsOptions.filter((annotationType) => this.target.show[annotationType])\n        }];\n    }\n}\n\nCheckmkAnnotationsQueryCtrl.templateUrl = 'partials/annotations.editor.html';"]}