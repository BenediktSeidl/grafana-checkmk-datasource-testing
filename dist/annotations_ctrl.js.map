{"version":3,"sources":["../src/annotations_ctrl.js"],"names":["showAnnotationsOptions","queryToConfig","query","show","reduce","all","option","showAnnotations","includes","site","host","hostregex","usehostregex","service","serviceregex","useserviceregex","CheckmkAnnotationsQueryCtrl","annotation","queries","config","datasource","sitesQuery","hostsQuery","servicesQuery","update","filter","annotationType","templateUrl"],"mappings":"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","file":"annotations_ctrl.js","sourcesContent":["const showAnnotationsOptions = [\n    'ok',\n    'warn',\n    'crit',\n    'unknown',\n    'flapping',\n    'host_down',\n    'in_downtime',\n    'outof_notification_period',\n    'outof_service_period',\n    'unmonitored'\n];\n\nconst queryToConfig = (query) => {\n    if(!query) {\n        return {};\n    }\n\n    const show = showAnnotationsOptions.reduce((all, option) => {\n        all[option] = query.showAnnotations.includes(option);\n        return all;\n    }, {});\n\n    return {\n        site: query.site,\n        host: query.host,\n        hostregex: query.hostregex,\n        usehostregex: query.usehostregex,\n        service: query.service,\n        serviceregex: query.serviceregex,\n        useserviceregex: query.usehostregex || query.useserviceregex,\n        show\n    };\n};\n\nexport class CheckmkAnnotationsQueryCtrl {\n    constructor(/*timeSrv, dashboardSrv*/) {\n        this.annotation.queries = this.annotation.queries || [];\n        this.config = queryToConfig(this.annotation.queries[0]);\n    }\n\n    getLastError() {\n        return null;\n    }\n\n    getSiteOptions() {\n        return this.datasource.sitesQuery(this.config, true);\n    }\n\n    getHostOptions() {\n        return this.datasource.hostsQuery(this.config);\n    }\n\n    getServiceOptions() {\n        return this.datasource.servicesQuery(this.config, false);\n    }\n\n    onSiteChange() {\n        this.config.host = '';\n        this.config.hostregex = '';\n        this.config.usehostregex = false;\n        this.config.service = '';\n        this.config.serviceregex = '';\n        this.config.useserviceregex = false;\n        this.update();\n    }\n\n    onHostChange() {\n        this.config.service = '';\n        this.config.hostregex = '';\n        this.update();\n    }\n\n    onHostRegexChange() {\n        this.config.service = '';\n        this.config.host = '';\n        this.update();\n    }\n\n    onServiceChange() {\n        this.config.serviceregex = '';\n        this.update();\n    }\n\n    onServiceRegexChange() {\n        this.config.service = '';\n        this.update();\n    }\n\n    onShowAnnotationChange() {\n        this.update();\n    }\n\n    update() {\n        this.annotation.queries = [{\n            site: this.config.site,\n            host: this.config.host,\n            hostregex: this.config.hostregex,\n            usehostregex: this.config.usehostregex,\n            service: this.config.service,\n            serviceregex: this.config.serviceregex,\n            useserviceregex: this.config.usehostregex || this.config.useserviceregex,\n            showAnnotations: showAnnotationsOptions.filter((annotationType) => this.config.show[annotationType])\n        }];\n    }\n}\n\nCheckmkAnnotationsQueryCtrl.templateUrl = 'partials/annotations.editor.html';"]}